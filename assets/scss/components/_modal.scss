/* Modal (theme-aware) */
.modal {
  /* ✨ 모달 전용 변수: 테마별로 표면/전경/오버레이 제어 */
  --modal-surface: var(--color-white);
  --modal-foreground: var(--color-darken);
  --modal-overlay: rgba(0, 0, 0, .45);

  position: fixed;
  inset: 0;
  z-index: 1000;
  display: none; /* aria-hidden="true"일 때 숨김 */

  &[aria-hidden="false"] { display: block; }

  .modal-overlay {
    position: absolute;
    inset: 0;
    background: var(--modal-overlay);
    backdrop-filter: blur(2px); /* 어둠 속에서도 레이어 분리감 */
  }

  .modal-container {
    position: relative;
    width: min(720px, calc(100% - 32px));
    max-height: calc(100dvh - 80px);
    margin: 40px auto;
    display: flex;
    flex-direction: column;
    background: var(--modal-surface);
    color: var(--modal-foreground);
    border-radius: 12px;
    box-shadow: 0 12px 36px rgba(0, 0, 0, .18);
    outline: none;
    transform: translateY(16px);
    opacity: 0;
    transition: transform .2s ease, opacity .2s ease;
  }

  &[aria-hidden="false"] .modal-container {
    transform: translateY(0);
    opacity: 1;
  }

  .modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    border-bottom: 1px solid var(--gray-500);

    .modal-title {
      font-size: 18px;
      font-weight: 700;
      color: inherit; /* 전경색 상속 */
    }

    .modal-close {
      width: 32px;
      height: 32px;
      border: 0;
      background: transparent;
      cursor: pointer;
      border-radius: 8px;
      position: relative;
      color: var(--modal-foreground); /* 아이콘 색 기준 */

      &::before,
      &::after {
        content: "";
        position: absolute;
        left: 50%;
        top: 50%;
        width: 18px;
        height: 2px;
        background: currentColor; /* 테마에 따라 자동 적응 */
        transform-origin: 50% 50%;
      }
      &::before { transform: translate(-50%, -50%) rotate(45deg); }
      &::after  { transform: translate(-50%, -50%) rotate(-45deg); }

      &:hover { background: var(--gray-200); }
      &:focus-visible { outline: 2px solid rgba(var(--color-primary-rgb), .4); outline-offset: 2px; }
    }
  }

  .modal-body {
    padding: 20px;
    overflow: auto;
    color: inherit;

    .table { min-width: 100%; }
  }

  .modal-footer {
    padding: 12px 20px;
    border-top: 1px solid var(--gray-500);
    display: flex;
    gap: 8px;
    justify-content: flex-end;
  }

  /* 사이즈 변형 */
  &-sm .modal-container { width: min(420px, calc(100% - 32px)); }
  &-lg .modal-container { width: min(1000px, calc(100% - 32px)); }

  /* 드로어형 (오른쪽 슬라이드) */
  &-drawer {
    .modal-container {
      margin: 0 0 0 auto;
      height: 100dvh;
      width: min(480px, 100%);
      border-radius: 0;
      transform: translateX(24px);
      opacity: 1;
    }
    &[aria-hidden="false"] .modal-container { transform: translateX(0); }
  }

  .box-wrap {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 24px;
    .box {
      width: 100%;
      min-width: 0;
      .flex * { min-width: 0; }
      &.col2 { grid-column: span 2; }
      &.col3 { grid-column: span 3; }
      &.col4 { grid-column: span 4; }
    }
  }
}

/* 바디 스크롤 잠금 */
.body-lock { overflow: hidden; }

/* 🌙 다크 테마 전용 오버라이드:
   - 표면을 밝게, 전경을 어둡게 역전
   - 오버레이를 조금 더 진하게 */
[data-theme="dark"] .modal {
  --modal-surface: var(--bg-darken);      /* 밝은 면: 다크에서도 확실히 떠 보임 */
  --modal-foreground: #121212;            /* 읽기 좋은 진한 본문색 */
  --modal-overlay: rgba(0, 0, 0, .6);
}
